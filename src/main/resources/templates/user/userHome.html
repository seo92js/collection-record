<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header" />

<body>
    <div th:replace="fragments/navigation :: navigation" />

    <header class="header">
        <h1 th:text="${username}" class="header__title"></h1>
    </header>

    <main class="user-home">

        <!-- 프로필 이미지, 메뉴 -->
        <div class="user-home__title">
            <div class="user-home__title-menu">
                <img class="user-home__title--image" th:if="${imageId != null}" th:src="@{/api/v1/image/{imageId}(imageId=${imageId})}">
                <div th:text="${profileText}"></div>
            </div>
            <div class="user-home__title-menu">
                <a class="user-home__title-submenu" th:if="${isFollowing == null}" href="/user/profile">내 정보</a>
                <a class="user-home__title-submenu" th:if="${isFollowing == null}" href="/category">카테고리 관리</a>
                <a class="user-home__title-submenu" th:if="${isFollowing == null}" href="/posts/add">글쓰기</a>

                <a class="user-home__title-submenu" th:if="${isFollowing != null}" th:href="@{/chatroom/{loginUserId}/{userId}(loginUserId=${loginUserId}, userId=${id})}" target="_blank">채팅</a>
            </div>

            <button type="button" th:if="${isFollowing == true}" th:onclick="deleteFollow([[${id}]])">팔로우 취소</button>
            <button type="button" th:if="${isFollowing == false}" th:onclick="createFollow([[${id}]]); sendNotification([[${loginUsername}]], [[${username}]])">팔로우</button>
        </div>

        <!-- 카테고리 목록 -->
        <div class="user-home__category">
            <ul>
                <li class="user-home__category-li"><a href="javascript:void(0)" th:data-id="${id}" th:data-category="all" class="category-link">전체</a></li>
                <li class="user-home__category-li" th:each="parentCategory : ${parentCategories}">
                    <a href="javascript:void(0)" th:text="${parentCategory.name}" th:data-id="${id}" th:data-category="${parentCategory.name}" class="category-link"></a>
                    <ul>
                        <li th:each="childCategory : ${childCategories}">
                            <a th:if="${childCategory.parentCategoryId == parentCategory.id}" href="javascript:void(0)" th:text="${childCategory.name}" th:data-id="${id}" th:data-category="${childCategory.name}" class="category-link"></a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>

        <!-- 게시물 목록 -->
        <div class="user-home__post" id="category-posts-list">
        </div>
    </main>

    <div th:replace="fragments/footer :: footer" />

    <script src="/js/show-category-posts.js"></script>
    <script src="/js/create-follow.js"></script>
    <script src="/js/delete-follow.js"></script>
    <script src="/js/send-notification-follow.js"></script>

</body>
</html>